<!-- Alerta sesión -->
<div *ngIf="sessionLink"
     class="alert alert-info d-flex justify-content-between align-items-center shadow-sm rounded-pill small mb-3 animate__animated animate__fadeInDown">
  <div>
    <strong>Sesión creada: </strong>
    <a [href]="sessionLink" class="fw-semibold text-decoration-none">{{ sessionLink }}</a>
  </div>
  <button class="btn btn-outline-light btn-sm rounded-pill px-3" (click)="copyLink()">
    <i class="bi bi-clipboard"></i> Copiar
  </button>
</div>

<div class="joint-app joint-theme-modern">
  <!-- HEADER -->
  <div class="app-header d-flex align-items-center justify-content-between shadow-lg rounded-4 px-4 py-3 bg-gradient-primary">

        <!-- BOTÓN SOLO -->
    <button class="btn btn-light btn-icon rounded-circle me-2 shadow-sm"
            type="button"
            aria-label="Abrir menú"
            (click)="onToggleSidebar()">
      <i class="bi bi-list"></i>
    </button>
 <!--    <div class="app-title d-flex align-items-center gap-2">
      <h1 class="m-0 fw-bold text-white animate__animated animate__fadeInLeft">Diagramador</h1>
      <span class="badge bg-light text-primary rounded-pill shadow-sm">Examen</span>
    </div> -->
    <div class="toolbar d-flex gap-2">
      <button class="btn btn-success rounded-pill shadow-sm px-4" (click)="createSession()">
        <i class="bi bi-plus-circle me-1"></i> Crear Sesión
      </button>
      <button class="btn btn-info text-white rounded-pill shadow-sm px-4" (click)="sendDiagramWithContext()">
        <i class="bi bi-magic me-1"></i> Generar Demo
      </button>
      <button class="btn btn-warning rounded-pill shadow-sm px-4" (click)="exportDiagram()">
        <i class="bi bi-box-arrow-down me-1"></i> Exportar
      </button>
      <button class="btn btn-outline-light rounded-pill shadow-sm px-4" (click)="createLinkWithIntermediateClass()">
        <i class="bi bi-diagram-3 me-1"></i> Clase Intermedia 'mucho a muchos'
      </button>
<!-- un text area para poder escriit ala ia  -->

      <!-- === IA: Generar diagrama desde prompt === -->
<div class="position-relative">
  <button class="btn btn-light rounded-pill shadow-sm px-3 d-flex align-items-center gap-2"
          (click)="iaOpen = !iaOpen">
    <i class="bi bi-robot"></i> Generar modelo
  </button>

  <div class="card border-0 shadow-lg p-3 ia-panel" *ngIf="iaOpen">
    <strong class="mb-2 d-block">Describe tu modelo</strong>

    <textarea class="form-control mb-2" rows="5"
              [(ngModel)]="iaPrompt"
              placeholder="Ej.: 
Clase Usuario: id:Long, nombre:String, edad:Int
Clase Rol: id:Long, nombre:String
Relaciones:
Usuario *..* Rol (muchos a muchos)">
    </textarea>

    <div class="d-flex gap-2">
      <button class="btn btn-primary w-100" [disabled]="iaBusy || !iaPrompt?.trim()"
              (click)="onGenerateFromPrompt()">
        <span *ngIf="!iaBusy"><i class="bi bi-stars me-1"></i>Generar</span>
        <span *ngIf="iaBusy" class="spinner-border spinner-border-sm me-1"></span>
      </button>
      <button class="btn btn-outline-secondary" type="button"
              (click)="iaPrompt = examplePrompt()">
        Ejemplo
      </button>
    </div>

    <div *ngIf="iaError" class="alert alert-danger my-2 py-2 px-3">{{ iaError }}</div>
  </div>
</div>


<!-- finaaaaaaaaaaaaaa -->
    </div>
  </div>

  <!-- CUERPO -->
  <div class="app-body d-flex flex-column mt-3">
    <div class="d-flex flex-grow-1 mt-4 gap-3">
      <!-- STENCIL -->
      <div class="stencil-container p-3 rounded-4 shadow bg-dark text-white animate__animated animate__fadeInLeft">
        <h3 class="mb-3 fw-semibold">Herramientas</h3>
        <!-- Aquí el stencil -->
      </div>

      <!-- CANVAS -->
      <div class="paper-container flex-grow-1 p-3 bg-white shadow rounded-4 animate__animated animate__fadeIn">
        <!-- Aquí estará el diagrama -->
      </div>

      <!-- INSPECTOR -->
      <div class="inspector-container p-3 bg-light shadow rounded-4 animate__animated animate__fadeInRight">
        <h5 class="fw-semibold text-secondary">Inspector</h5>
        <!-- Inspector -->
      </div>
    </div>
  </div>

  <!-- NAVEGADOR -->
  <div class="navigator-container mt-3 bg-white p-3 rounded-4 shadow-sm animate__animated animate__fadeInUp">
    <!-- Aquí estará el navegador -->
  </div>
</div>
